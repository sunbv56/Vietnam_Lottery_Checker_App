<!-- Settings Modal -->
<div id="settings-modal" class="modal items-center justify-center">
    <div class="premium-glass rounded-[2rem] p-8 w-full max-w-md m-4 border-[var(--glass-border)] relative shadow-2xl">
        <button id="close-settings" class="absolute top-6 right-6 text-[var(--text-muted)] hover:text-white">
            <i class="fas fa-times"></i>
        </button>

        <h3 class="text-2xl font-bold mb-6">Cài đặt</h3>

        <div class="space-y-6">
            <div>
                <label class="block text-xs font-bold uppercase tracking-wider text-[var(--text-muted)] mb-3">Giao
                    diện ứng
                    dụng</label>
                <div class="relative group">
                    <select id="theme-select"
                        class="w-full bg-[var(--input-bg)] border border-[var(--glass-border)] rounded-2xl px-5 py-4 focus:outline-none focus:border-orange-500 appearance-none cursor-pointer transition-all hover:bg-[var(--input-bg)] text-[var(--text-main)]">
                        <option value="auto" class="bg-[var(--bg-main)] text-[var(--text-main)]">Mặc định hệ thống
                        </option>
                        <option value="light" class="bg-[var(--bg-main)] text-[var(--text-main)]">Giao diện sáng
                        </option>
                        <option value="dark" class="bg-[var(--bg-main)] text-[var(--text-main)]">Giao diện tối
                        </option>
                        <option value="gold" class="bg-[var(--bg-main)] text-[var(--text-main)]">Imperial Gold
                            (Premium)</option>
                        <option value="cyberpunk" class="bg-[var(--bg-main)] text-[var(--text-main)]">Cyberpunk Neon
                        </option>
                    </select>
                    <i
                        class="fas fa-chevron-down absolute right-5 top-1/2 -translate-y-1/2 text-[var(--text-muted)] pointer-events-none transition-transform group-hover:text-orange-500"></i>
                </div>
            </div>

            <div>
                <label class="block text-xs font-bold uppercase tracking-wider text-[var(--text-muted)] mb-3">AI API
                    Key
                    (Cá nhân)</label>
                <input type="password" id="api-key-input" placeholder="Dán API key tại đây..."
                    class="w-full bg-[var(--input-bg)] border border-[var(--glass-border)] rounded-2xl px-5 py-4 focus:outline-none focus:border-orange-500 transition-all text-[var(--text-main)]">
            </div>

            <div class="p-4 rounded-2xl bg-orange-500/10 border border-orange-500/20">
                <div class="flex gap-3">
                    <i class="fas fa-shield-alt text-orange-500 mt-1"></i>
                    <div>
                        <p class="text-sm font-bold text-orange-200">Bảo mật của bạn</p>
                        <p class="text-[11px] text-orange-200/60 leading-relaxed mt-1">
                            Key được lưu duy nhất tại trình duyệt của bạn (LocalStorage).
                            Chúng tôi cam kết không lưu lại thông tin này trên server.
                        </p>
                    </div>
                </div>
            </div>

            <button id="save-settings"
                class="w-full gradient-bg py-4 rounded-2xl font-bold btn-hover uppercase tracking-widest text-sm">
                Lưu cấu hình
            </button>
        </div>
    </div>
</div>

<!-- Results Modal -->
<div id="results-modal" class="modal items-center justify-center">
    <canvas id="confetti-canvas" class="confetti-canvas"></canvas>
    <div
        class="modal-content-glass rounded-[2.5rem] p-6 md:p-12 w-full max-w-3xl m-4 border-[var(--glass-border)] relative shadow-2xl max-h-[90vh] overflow-y-auto custom-scrollbar animate-fade-in">
        <div class="mobile-handle"></div>
        <button id="close-results"
            class="absolute top-4 right-4 md:top-8 md:right-8 text-[var(--text-muted)] hover:text-white z-10 p-2 transition-transform hover:scale-110">
            <i class="fas fa-times text-xl md:text-2xl"></i>
        </button>

        <div id="modal-win-container" class="hidden">
            <div class="text-center mb-6 md:mb-8">
                <div class="inline-block p-3 rounded-full bg-yellow-500/10 mb-3 win-glow">
                    <i class="fas fa-trophy text-3xl md:text-4xl text-yellow-500/80"></i>
                </div>
                <h2 class="text-2xl md:text-3xl font-bold text-[var(--text-main)] mb-1 italic">CHÚC MỪNG BẠN!</h2>
                <p class="text-[var(--text-muted)] uppercase tracking-[0.2em] text-[9px] md:text-[10px] font-bold">
                    Bạn đã
                    trúng giải</p>
            </div>

            <div id="modal-prize-display" class="flex flex-col gap-4 mb-10">
                <!-- Winning prizes will be injected here with big typography -->
            </div>
        </div>

        <div id="modal-lose-container" class="hidden">
            <div class="text-center mb-8 md:mb-10">
                <div class="inline-block p-4 rounded-full bg-slate-500/10 mb-4">
                    <i class="fas fa-heart text-4xl md:text-5xl text-pink-500/50"></i>
                </div>
                <h2 class="text-2xl md:text-3xl font-bold text-[var(--text-main)] mb-2">Hẹn Bạn Lần Sau</h2>
                <p class="text-[var(--text-muted)] uppercase tracking-widest text-[10px] md:text-xs font-bold">Không
                    trúng
                    giải kỳ này</p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
            <div
                class="premium-glass p-5 rounded-3xl bg-[var(--input-bg)] border-[var(--glass-border)] flex items-center gap-4">
                <div class="w-12 h-12 rounded-2xl bg-orange-500/10 flex items-center justify-center text-orange-500">
                    <i class="fas fa-map-marker-alt"></i>
                </div>
                <div>
                    <p class="text-[var(--text-muted)] text-[10px] uppercase font-bold tracking-tighter">Tỉnh Thành
                    </p>
                    <p id="modal-res-province" class="text-[var(--text-main)] font-bold text-lg">---</p>
                </div>
            </div>
            <div
                class="premium-glass p-5 rounded-3xl bg-[var(--input-bg)] border-[var(--glass-border)] flex items-center gap-4">
                <div class="w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-500">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div>
                    <p class="text-[var(--text-muted)] text-[10px] uppercase font-bold tracking-tighter">Ngày Mở
                        Thưởng</p>
                    <p id="modal-res-date" class="text-[var(--text-main)] font-bold text-lg">--/--/----</p>
                </div>
            </div>
            <div
                class="md:col-span-2 premium-glass p-5 md:p-6 rounded-2xl md:rounded-3xl text-center bg-[var(--input-bg)] border-[var(--glass-border)] relative overflow-hidden group">
                <p class="text-[var(--text-muted)] text-[10px] uppercase font-bold tracking-[0.2em] mb-2">Số Của Bạn
                </p>
                <p id="modal-res-number"
                    class="text-3xl md:text-4xl font-black tracking-[0.1em] text-[var(--text-main)]">------
                </p>
            </div>
        </div>

        <div class="space-y-4">
            <div class="flex items-center justify-between px-2">
                <h3 class="text-xs font-bold uppercase text-[var(--text-muted)] tracking-widest">Chi tiết kết quả
                    nhà đài</h3>
                <div class="h-px bg-[var(--input-bg)] flex-grow ml-4"></div>
            </div>
            <div id="modal-results-table-container"></div>
        </div>

        <div class="mt-8 md:mt-12 flex flex-col sm:flex-row gap-3 md:gap-4">
            <button id="close-results-btn"
                class="flex-grow bg-[var(--input-bg)] py-4 md:py-5 rounded-2xl md:rounded-[1.5rem] font-bold hover:bg-white/20 transition-all uppercase tracking-widest text-xs md:text-sm border border-[var(--glass-border)]">
                <span>Đã hiểu</span>
            </button>
            <button id="share-win-btn" onclick="downloadWinImage()"
                class="flex-grow gradient-bg py-4 md:py-5 rounded-2xl md:rounded-[1.5rem] font-bold btn-hover uppercase tracking-widest text-xs md:text-sm shadow-xl shadow-orange-500/20 flex items-center justify-center gap-2 hidden">
                <i class="fas fa-share-alt"></i>
                <span>Chia sẻ</span>
            </button>
        </div>
    </div>
</div>

<!-- Camera Modal -->
<div id="camera-ui" class="camera-modal">
    <div class="camera-wrapper">
        <div class="camera-video-container">
            <video id="video" autoplay playsinline></video>
            <div class="scan-overlay">
                <div class="scan-frame">
                    <div class="corner corner-tl"></div>
                    <div class="corner corner-tr"></div>
                    <div class="corner corner-bl"></div>
                    <div class="corner corner-br"></div>
                    <div class="scan-laser"></div>
                </div>
            </div>
        </div>
        <div class="camera-controls-container">
            <div class="flex justify-center items-center gap-10 md:gap-14">
                <button id="flip-camera"
                    class="w-14 h-14 rounded-full premium-glass text-white/40 hover:text-white transition-all flex items-center justify-center text-xl hover:bg-[var(--input-bg)]">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button id="capture-btn"
                    class="w-24 h-24 rounded-full border-4 border-[var(--glass-border)] p-1 group relative">
                    <div
                        class="w-full h-full bg-white rounded-full group-hover:scale-90 transition-transform flex items-center justify-center text-black shadow-[0_0_20px_rgba(255,255,255,0.3)]">
                        <div class="w-16 h-16 rounded-full border border-black/10 flex items-center justify-center">
                            <i class="fas fa-camera text-2xl"></i>
                        </div>
                    </div>
                    <div class="absolute -inset-2 border border-[var(--glass-border)] rounded-full animate-pulse">
                    </div>
                </button>
                <button id="close-camera"
                    class="w-14 h-14 rounded-full premium-glass text-white/40 hover:text-red-400 transition-all flex items-center justify-center text-xl hover:bg-[var(--input-bg)]">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="text-center space-y-1">
                <p class="text-orange-500/80 text-[10px] font-black uppercase tracking-[0.3em]">Smart Scanning
                    Active</p>
                <p class="text-slate-600 text-[8px] uppercase tracking-widest font-bold">Giữ điện thoại ổn định để
                    kết quả chính xác nhất</p>
            </div>
        </div>
    </div>
</div>